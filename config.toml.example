# SSH Honeypot Configuration Example
# Copy this file to config.toml and modify as needed

# PostgreSQL database connection URL
# Format: postgresql://username:password@hostname:port/database_name
# Default: Uses local PostgreSQL with honeypot user
database_url = "postgresql://honeypot:honeypot@localhost:5432/ssh_honeypot"

# Network interfaces to listen on (can specify multiple)
# Default: ["0.0.0.0:2222", "[::]:2222"] (IPv4 and IPv6)
interfaces = [
    "0.0.0.0:2222",        # IPv4 all interfaces
    "[::]:2222",           # IPv6 all interfaces  
    # "192.168.1.100:22",  # Specific IPv4 interface
    # "127.0.0.1:2223",    # Local testing
]

# Disable the interactive shell simulation (only log auth attempts)
# Default: false
disable_cli_interface = false

# SSH authentication banner (makes honeypot appear more realistic)
# Default: none
authentication_banner = "Ubuntu 22.04.3 LTS"

# Enable tarpit mode (slow responses to waste attacker time)
# Default: false
tarpit = false

# Disable loading base filesystem from base.tar.gz
# Default: false (loads debian 12 filesystem simulation)
disable_base_tar_gz_loading = false

# Path to base filesystem archive (for realistic file simulation)
# Default: uses XDG data directory or ./base.tar.gz
# base_tar_gz_path = "/path/to/custom/base.tar.gz"

# Directory containing SSH server keys
# Default: uses XDG config directory or ./keys
# key_folder = "/path/to/ssh/keys"

# Network socket options (advanced)
disable_so_reuseport = false
disable_so_reuseaddr = false

# Disable SFTP subsystem support
# Default: false (SFTP enabled for file upload capture)
disable_sftp = false

# AbuseIPDB API key for IP reputation checking
# Get your free API key at: https://www.abuseipdb.com/api
# Default: none (AbuseIPDB integration disabled)
abuse_ip_db_api_key = "your_api_key_here"

# AbuseIPDB cache cleanup interval in hours
# How often to clean up expired database cache entries (default: 24 hours)
# Note: Cache entries expire after 24 hours but cleanup only happens at this interval
abuse_ip_cache_cleanup_interval_hours = 24

##############################################################################
# Environment Variable Equivalents
##############################################################################
# All config options can also be set via environment variables:
#
# DATABASE_URL=postgresql://user:pass@host:port/db
# INTERFACE=0.0.0.0:2222
# DISABLE_CLI_INTERFACE=true
# AUTHENTICATION_BANNER="Ubuntu 22.04.3 LTS"  
# TARPIT=true
# DISABLE_BASE_TAR_GZ_LOADING=true
# BASE_TAR_GZ_PATH=/path/to/base.tar.gz
# KEY_FOLDER=/path/to/keys
# DISABLE_SO_REUSEPORT=true
# DISABLE_SO_REUSEADDR=true
# DISABLE_SFTP=true
# ABUSE_IP_DB_API_KEY=your_api_key_here
# ABUSE_IP_CACHE_CLEANUP_HOURS=24
#
# CLI arguments take precedence over config file, which takes precedence over environment variables.
